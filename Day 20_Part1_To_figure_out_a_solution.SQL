-- Part 1 - To find a solution

drop table if exists #input 

select [Id] = '1' , [col] = '###############' into #input union all select [Id] = '2' , [col] = '#...#...#.....#' union all select [Id] = '3' , [col] = '#.#.#.#.#.###.#' union all select [Id] = '4' , [col] = '#S#...#.#.#...#' union all select [Id] = '5' , [col] = '#######.#.#.###' union all select [Id] = '6' , [col] = '#######.#.#...#' union all select [Id] = '7' , [col] = '#######.#.###.#' union all select [Id] = '8' , [col] = '###..E#...#...#' union all select [Id] = '9' , [col] = '###.#######.###' union all select [Id] = '10' , [col] = '#...###...#...#' union all select [Id] = '11' , [col] = '#.#####.#.###.#' union all select [Id] = '12' , [col] = '#.#...#.#.#...#' union all select [Id] = '13' , [col] = '#.#.#.#.#.#.###' union all select [Id] = '14' , [col] = '#...#...#...###' union all select [Id] = '15' , [col] = '###############' 

-- select [Id] = '1' , [col] = '#############################################################################################################################################' into #input  union all select [Id] = '2' , [col] = '#.......#...###...#.......#...#.......###...###...#...#...###.........#...#...#...#...#.....###...###...###...###.......#...#...#...#.......#' union all select [Id] = '3' , [col] = '#.#####.#.#.###.#.#.#####.#.#.#.#####.###.#.###.#.#.#.#.#.###.#######.#.#.#.#.#.#.#.#.#.###.###.#.###.#.###.#.###.#####.#.#.#.#.#.#.#.#####.#' union all select [Id] = '4' , [col] = '#...#...#.#.#...#.#.....#.#.#.#...#...#...#.....#.#.#...#.....#.......#.#.#.#.#.#.#.#.#...#.#...#.....#...#.#.#...#.....#.#.#.#...#.#.#.....#' union all select [Id] = '5' , [col] = '###.#.###.#.#.###.#####.#.#.#.###.#.###.#########.#.###########.#######.#.#.#.#.#.#.#.###.#.#.###########.#.#.#.###.#####.#.#.#####.#.#.#####' union all select [Id] = '6' , [col] = '#...#...#.#.#...#.#.....#...#...#.#...#.........#.#.#.....#.....#.....#.#.#.#...#.#.#.#...#.#.#.........#...#.#...#.......#.#.#.....#.#.....#' union all select [Id] = '7' , [col] = '#.#####.#.#.###.#.#.###########.#.###.#########.#.#.#.###.#.#####.###.#.#.#.#####.#.#.#.###.#.#.#######.#####.###.#########.#.#.#####.#####.#' union all select [Id] = '8' , [col] = '#.....#.#.#.#...#...#.......#...#...#.###...#...#...#...#...#...#...#.#.#.#.#.....#.#.#...#...#.......#...#...###...#.......#.#.#...#.#.....#' union all select [Id] = '9' , [col] = '#####.#.#.#.#.#######.#####.#.#####.#.###.#.#.#########.#####.#.###.#.#.#.#.#.#####.#.###.###########.###.#.#######.#.#######.#.#.#.#.#.#####' union all select [Id] = '10' , [col] = '#.....#...#.#.....#...#.....#.#.....#.....#.#...#.....#.....#.#.###.#.#.#.#.#.......#.###...#.......#...#.#.#.......#.#...###.#.#.#.#.#.#...#' union all select [Id] = '11' , [col] = '#.#########.#####.#.###.#####.#.###########.###.#.###.#####.#.#.###.#.#.#.#.#########.#####.#.#####.###.#.#.#.#######.#.#.###.#.#.#.#.#.#.#.#' union all select [Id] = '12' , [col] = '#.........#...#...#.###.....#.#.........#...#...#.###.......#.#.#...#...#.#.#...#.....#.....#.....#.#...#...#.......#.#.#.....#.#.#.#.#...#.#' union all select [Id] = '13' , [col] = '#########.###.#.###.#######.#.#########.#.###.###.###########.#.#.#######.#.#.#.#.#####.#########.#.#.#############.#.#.#######.#.#.#.#####.#' union all select [Id] = '14' , [col] = '#.........#...#...#.#.......#...#...#...#.#...#...#.......###.#.#.......#...#.#...#...#.....#.....#.#...###...###...#...#.......#.#.#.#.....#' union all select [Id] = '15' , [col] = '#.#########.#####.#.#.#########.#.#.#.###.#.###.###.#####.###.#.#######.#####.#####.#.#####.#.#####.###.###.#.###.#######.#######.#.#.#.#####' union all select [Id] = '16' , [col] = '#.........#...###...#.......#...#.#.#.#...#...#.#...#...#.#...#.#...#...#.....#...#.#.#.....#.#...#.....#...#.#...#...#...#...###.#.#.#.#...#' union all select [Id] = '17' , [col] = '#########.###.#############.#.###.#.#.#.#####.#.#.###.#.#.#.###.#.#.#.###.#####.#.#.#.#.#####.#.#.#######.###.#.###.#.#.###.#.###.#.#.#.#.#.#' union all select [Id] = '18' , [col] = '#...#...#...#.....###.....#.#.....#...#.#...#.#...#...#...#...#...#...#...#...#.#.#.#.#.....#...#...#...#.#...#.#...#...###.#.....#...#...#.#' union all select [Id] = '19' , [col] = '#.#.#.#.###.#####.###.###.#.###########.#.#.#.#####.#########.#########.###.#.#.#.#.#.#####.#######.#.#.#.#.###.#.#########.###############.#' union all select [Id] = '20' , [col] = '#.#...#...#.....#...#...#.#.........#...#.#...#...#.......###.........#...#.#...#...#.....#.#.......#.#.#.#.....#...###...#.....#...........#' union all select [Id] = '21' , [col] = '#.#######.#####.###.###.#.#########.#.###.#####.#.#######.###########.###.#.#############.#.#.#######.#.#.#########.###.#.#####.#.###########' union all select [Id] = '22' , [col] = '#.#.......#...#...#.#...#.......#...#.....#...#.#.........#...#...#...#...#.#.............#.#.#...#...#.#.......#...#...#...#...#...........#' union all select [Id] = '23' , [col] = '#.#.#######.#.###.#.#.#########.#.#########.#.#.###########.#.#.#.#.###.###.#.#############.#.#.#.#.###.#######.#.###.#####.#.#############.#' union all select [Id] = '24' , [col] = '#.#...#...#.#.....#.#.........#.#.....#.....#.#.#...#...#...#...#.#...#.#...#.......#...#...#.#.#.#.#...#...#...#.#...#.....#...#...........#' union all select [Id] = '25' , [col] = '#.###.#.#.#.#######.#########.#.#####.#.#####.#.#.#.#.#.#.#######.###.#.#.#########.#.#.#.###.#.#.#.#.###.#.#.###.#.###.#######.#.###########' union all select [Id] = '26' , [col] = '#...#.#.#.#.......#.#...#.....#.......#.....#...#.#.#.#.#.#.......#...#...#.........#.#.#...#...#.#.#.#...#...#...#...#...#...#.#.#.........#' union all select [Id] = '27' , [col] = '###.#.#.#.#######.#.#.#.#.#################.#####.#.#.#.#.#.#######.#######.#########.#.###.#####.#.#.#.#######.#####.###.#.#.#.#.#.#######.#' union all select [Id] = '28' , [col] = '#...#...#...###...#...#.#.#...#.........#...#...#.#...#.#.#.#...#...#.......###...###.#...#.....#...#.#.......#...#...#...#.#.#.#...#.......#' union all select [Id] = '29' , [col] = '#.#########.###.#######.#.#.#.#.#######.#.###.#.#.#####.#.#.#.#.#.###.#########.#.###.###.#####.#####.#######.###.#.###.###.#.#.#####.#######' union all select [Id] = '30' , [col] = '#.#...#...#...#.....#...#...#...###.....#...#.#.#.....#.#.#.#.#.#...#.###.......#...#.#...#.....#.....#...###.#...#.#...#...#...#...#.......#' union all select [Id] = '31' , [col] = '#.#.#.#.#.###.#####.#.#############.#######.#.#.#####.#.#.#.#.#.###.#.###.#########.#.#.###.#####.#####.#.###.#.###.#.###.#######.#.#######.#' union all select [Id] = '32' , [col] = '#.#.#...#...#.....#.#...###...#...#.....#...#.#.#.....#.#.#...#.#...#...#.....#.....#.#...#.....#.#...#.#...#.#.###.#.....#.......#.........#' union all select [Id] = '33' , [col] = '#.#.#######.#####.#.###.###.#.#.#.#####.#.###.#.#.#####.#.#####.#.#####.#####.#.#####.###.#####.#.#.#.#.###.#.#.###.#######.#################' union all select [Id] = '34' , [col] = '#.#...#...#.....#.#.#...#...#...#.....#.#.###.#.#.....#.#.#.....#.#.....#...#.#.#...#.#...#...#.#.#.#.#.#...#.#.#...#.....#.......#.........#' union all select [Id] = '35' , [col] = '#.###.#.#.#####.#.#.#.###.###########.#.#.###.#.#####.#.#.#.#####.#.#####.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.###.#.#.###.###.#######.#.#######.#' union all select [Id] = '36' , [col] = '#.#...#.#.#.....#...#.###...........#.#.#.#...#.#...#.#...#.#...#.#...#...#.#.#.#.#...#...#.#...#.#.#.#.#.....#...#...###...#.....#.#.......#' union all select [Id] = '37' , [col] = '#.#.###.#.#.#########.#############.#.#.#.#.###.#.#.#.#####.#.#.#.###.#.###.#.#.#.#######.#.#####.#.#.#.###########.#######.#.#####.#.#######' union all select [Id] = '38' , [col] = '#.#.#...#...#...#...#...#...........#...#.#...#.#.#.#.#.....#.#.#...#.#.#...#.#.#.....#...#...###...#...#.......#...###...#.#.......#.#.....#' union all select [Id] = '39' , [col] = '#.#.#.#######.#.#.#.###.#.###############.###.#.#.#.#.#.#####.#.###.#.#.#.###.#.#####.#.#####.###########.#####.#.#####.#.#.#########.#.###.#' union all select [Id] = '40' , [col] = '#...#.........#...#.#...#...............#.....#.#.#...#.#.....#.#...#.#.#.....#...#...#...#...#...........#...#...###...#.#...#.....#...#...#' union all select [Id] = '41' , [col] = '###################.#.#################.#######.#.#####.#.#####.#.###.#.#########.#.#####.#.###.###########.#.#######.###.###.#.###.#####.###' union all select [Id] = '42' , [col] = '###...#.............#...#...#...###...#.......#...#...#.#.....#...###...###...#...#.....#.#.#...#.....#...#.#...#...#...#...#...###...#...###' union all select [Id] = '43' , [col] = '###.#.#.###############.#.#.#.#.###.#.#######.#####.#.#.#####.#############.#.#.#######.#.#.#.###.###.#.#.#.###.#.#.###.###.#########.#.#####' union all select [Id] = '44' , [col] = '#...#...#.........#...#...#...#.....#.#.....#.......#.#...#...###...........#...#...#...#.#.#.#...###...#...#...#.#...#.#...###...###...#...#' union all select [Id] = '45' , [col] = '#.#######.#######.#.#.###############.#.###.#########.###.#.#####.###############.#.#.###.#.#.#.#############.###.###.#.#.#####.#.#######.#.#' union all select [Id] = '46' , [col] = '#.#...#...#.......#.#.....#...#.....#...###...#...#...#...#.....#...#...#...#...#.#.#.#...#.#.#.#...#...#...#.....#...#.#.#...#.#.........#.#' union all select [Id] = '47' , [col] = '#.#.#.#.###.#######.#####.#.#.#.###.#########.#.#.#.###.#######.###.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#######.###.#.#.#.#.###########.#' union all select [Id] = '48' , [col] = '#.#.#...#...#...#...#.....#.#.#.#...###.....#.#.#.#.#...#...#...#...#.#.#.#.#.#.#.#...#...#.#...#.#...#...#.......#.....#...#...#...........#' union all select [Id] = '49' , [col] = '#.#.#####.###.#.#.###.#####.#.#.#.#####.###.#.#.#.#.#.###.#.#.###.###.#.#.#.#.#.#.#######.#.#####.###############.###############.###########' union all select [Id] = '50' , [col] = '#.#...###.....#...###...#...#...#...#...#...#.#.#.#.#...#.#.#.###...#.#...#.#.#.#.#.......#.#...#...............#...............#.........###' union all select [Id] = '51' , [col] = '#.###.#################.#.#########.#.###.###.#.#.#.###.#.#.#.#####.#.#####.#.#.#.#.#######.#.#.###############.###############.#########.###' union all select [Id] = '52' , [col] = '#.....#...#.............#...#.....#...#...###...#...###.#.#.#.#.....#.....#...#...#.........#.#.............#...###...#...#...#.........#...#' union all select [Id] = '53' , [col] = '#######.#.#.###############.#.###.#####.###############.#.#.#.#.#########.###################.#############.#.#####.#.#.#.#.#.#########.###.#' union all select [Id] = '54' , [col] = '#.....#.#.#...............#.#...#.......#...###...#...#.#.#.#.#.....#...#...###...###.........#...#.......#.#.......#...#...#.........#.....#' union all select [Id] = '55' , [col] = '#.###.#.#.###############.#.###.#########.#.###.#.#.#.#.#.#.#.#####.#.#.###.###.#.###.#########.#.#.#####.#.#########################.#######' union all select [Id] = '56' , [col] = '#...#.#.#...#...#.........#.###...........#.....#...#.#...#.#.###...#.#...#...#.#.....#...#.....#...#.....#...#...#...#...#...#.....#.......#' union all select [Id] = '57' , [col] = '###.#.#.###.#.#.#.#########.#########################.#####.#.###.###.###.###.#.#######.#.#.#########.#######.#.#.#.#.#.#.#.#.#.###.#######.#' union all select [Id] = '58' , [col] = '#...#.#...#.#.#.#...#.......#...###.....#.......#...#...###.#...#...#.###...#.#.#.....#.#...#.......#.......#.#.#...#...#...#.#...#.........#' union all select [Id] = '59' , [col] = '#.###.###.#.#.#.###.#.#######.#.###.###.#.#####.#.#.###.###.###.###.#.#####.#.#.#.###.#.#####.#####.#######.#.#.#############.###.###########' union all select [Id] = '60' , [col] = '#...#...#.#.#.#...#...#...#...#.#...###.#.....#...#...#...#...#.#...#.....#...#.#.#...#...###.....#.........#...#...........#.....#.........#' union all select [Id] = '61' , [col] = '###.###.#.#.#.###.#####.#.#.###.#.#####.#####.#######.###.###.#.#.#######.#####.#.#.#####.#######.###############.#########.#######.#######.#' union all select [Id] = '62' , [col] = '###...#.#.#.#...#.#...#.#.#...#.#.....#.......#.......#...###.#.#...#...#...###...#...#...#.......#.............#.#...#.....###...#.#.......#' union all select [Id] = '63' , [col] = '#####.#.#.#.###.#.#.#.#.#.###.#.#####.#########.#######.#####.#.###.#.#.###.#########.#.###.#######.###########.#.#.#.#.#######.#.#.#.#######' union all select [Id] = '64' , [col] = '#.....#...#.#...#...#.#.#.....#.......#...#...#.........#...#...###.#.#...#.....#...#...###.........#...#.......#...#.#.#.......#...#...#...#' union all select [Id] = '65' , [col] = '#.#########.#.#######.#.###############.#.#.#.###########.#.#######.#.###.#####.#.#.#################.#.#.###########.#.#.#############.#.#.#' union all select [Id] = '66' , [col] = '#.........#.#.......#.#.#...............#.#.#...#...#...#.#...#...#...###.#...#.#.#.#.................#...###...###...#...#.....#.....#...#.#' union all select [Id] = '67' , [col] = '#########.#.#######.#.#.#.###############.#.###.#.#.#.#.#.###.#.#.#######.#.#.#.#.#.#.#######################.#.###.#######.###.#.###.#####.#' union all select [Id] = '68' , [col] = '#...#...#.#.....#...#.#...#...#...........#.#...#.#.#.#.#...#.#.#.....#...#.#...#.#...#...#...#.............#.#.#...#.....#...#.#.#...#...#.#' union all select [Id] = '69' , [col] = '#.#.#.#.#.#####.#.###.#####.#.#.###########.#.###.#.#.#.###.#.#.#####.#.###.#####.#####.#.#.#.#.###########.#.#.#.###.###.###.#.#.#.###.#.#.#' union all select [Id] = '70' , [col] = '#.#...#.#.....#.#...#...#...#...#.........#.#.....#...#.....#...#.....#.#...#...#.#...#.#...#...#...........#.#...#...#...#...#...#.....#.#.#' union all select [Id] = '71' , [col] = '#.#####.#####.#.###.###.#.#######.#######.#.#####################.#####.#.###.#.#.#.#.#.#########.###########.#####.###.###.#############.#.#' union all select [Id] = '72' , [col] = '#.....#.......#...#.#...#.........#.......#.#.........#...#.....#...###...#...#.#...#...###.......#...#...###.#.....###...#.#...#...#...#.#.#' union all select [Id] = '73' , [col] = '#####.###########.#.#.#############.#######.#.#######.#.#.#.###.###.#######.###.###########.#######.#.#.#.###.#.#########.#.#.#.#.#.#.#.#.#.#' union all select [Id] = '74' , [col] = '#.....#...#.....#...#...###...###...###...#.#.....###...#...###...#.#.....#...#.###...#.....#.....#.#...#.....#...#...###.#...#.#.#...#.#...#' union all select [Id] = '75' , [col] = '#.#####.#.#.###.#######.###.#.###.#####.#.#.#####.###############.#.#.###.###.#.###.#.#.#####.###.#.#############.#.#.###.#####.#.#####.#####' union all select [Id] = '76' , [col] = '#.#...#.#...###...#...#.....#...#...#...#...#...#.......#...#...#...#...#.###.#.....#.#...#...#...#.#...........#...#...#.....#...#.....#...#' union all select [Id] = '77' , [col] = '#.#.#.#.#########.#.#.#########.###.#.#######.#.#######.#.#.#.#.#######.#.###.#######.###.#.###.###.#.#########.#######.#####.#####.#####.#.#' union all select [Id] = '78' , [col] = '#.#.#.#.###...###...#.#...#...#.....#...#...#.#.#.......#.#...#...#.....#.....#.......###...###.....#.........#.#.....#.....#.....#.....#.#.#' union all select [Id] = '79' , [col] = '#.#.#.#.###.#.#######.#.#.#.#.#########.#.#.#.#.#.#######.#######.#.###########.#############################.#.#.###.#####.#####.#####.#.#.#' union all select [Id] = '80' , [col] = '#...#...#...#.........#.#.#.#...#...###.#.#...#.#...#...#.#.......#...........#.###...#...###.................#...###.......#...#.......#.#.#' union all select [Id] = '81' , [col] = '#########.#############.#.#.###.#.#.###.#.#####.###.#.#.#.#.#################.#.###.#.#.#.###.###############################.#.#########.#.#' union all select [Id] = '82' , [col] = '#.....#...#...#...#...#.#.#.###...#.....#...###...#...#...#...#...#...#.......#...#.#.#.#...#.#.................#######.......#.......###.#.#' union all select [Id] = '83' , [col] = '#.###.#.###.#.#.#.#.#.#.#.#.###############.#####.###########.#.#.#.#.#.#########.#.#.#.###.#.#.###############.#######.#############.###.#.#' union all select [Id] = '84' , [col] = '#...#...#...#.#.#.#.#.#.#.#.#.............#...###.....#.......#.#.#.#.#.......#...#.#.#.#...#...#...#...#.....#...###...#...#.........#...#.#' union all select [Id] = '85' , [col] = '###.#####.###.#.#.#.#.#.#.#.#.###########.###.#######.#.#######.#.#.#.#######.#.###.#.#.#.#######.#.#.#.#.###.###.###.###.#.#.#########.###.#' union all select [Id] = '86' , [col] = '###...#...###...#.#.#...#...#.........#...#...#.....#.#.#.......#.#.#.#...###.#.#...#.#.#...#...#.#.#.#...###...#.#...#...#...#.........#...#' union all select [Id] = '87' , [col] = '#####.#.#########.#.#################.#.###.###.###.#.#.#.#######.#.#.#.#.###.#.#.###.#.###.#.#.#.#.#.#########.#.#.###.#######.#########.###' union all select [Id] = '88' , [col] = '#.....#.#...#...#.#.#.................#...#...#.#...#...#...#...#...#...#.#...#.#.#...#...#...#.#.#.#.....#...#...#.#...###.....#.........###' union all select [Id] = '89' , [col] = '#.#####.#.#.#.#.#.#.#.###################.###.#.#.#########.#.#.#########.#.###.#.#.#####.#####.#.#.#####.#.#.#####.#.#####.#####.###########' union all select [Id] = '90' , [col] = '#.......#.#...#.#...#...................#...#...#.#...#...#...#.....#.....#...#.#.#E#####.....#.#.#.#...#...#.......#.......#...#...........#' union all select [Id] = '91' , [col] = '#########.#####.#######################.###.#####.#.#.#.#.#########.#.#######.#.#.###########.#.#.#.#.#.#####################.#.###########.#' union all select [Id] = '92' , [col] = '#...#...#.....#.#...#.................#...#.#.....#.#.#.#...###.....#.....#...#...###########.#...#...#.#.......#.....#.......#...........#.#' union all select [Id] = '93' , [col] = '#.#.#.#.#####.#.#.#.#.###############.###.#.#.#####.#.#.###.###.#########.#.#################.#########.#.#####.#.###.#.#################.#.#' union all select [Id] = '94' , [col] = '#.#...#.......#.#.#...#...#.........#.....#...#...#.#.#...#...#.....#.....#.......###########.......#...#...#...#...#...#.......#...#...#...#' union all select [Id] = '95' , [col] = '#.#############.#.#####.#.#.#######.###########.#.#.#.###.###.#####.#.###########.#################.#.#####.#.#####.#####.#####.#.#.#.#.#####' union all select [Id] = '96' , [col] = '#.............#.#.#...#.#.#.#.....#.......#...#.#.#.#.#...#...#.....#.....#...#...#########.........#.......#.......#.....#...#...#...#...###' union all select [Id] = '97' , [col] = '#############.#.#.#.#.#.#.#.#.###.#######.#.#.#.#.#.#.#.###.###.#########.#.#.#.###########.#########################.#####.#.###########.###' union all select [Id] = '98' , [col] = '#.........###.#.#...#...#...#...#.....#...#.#.#.#.#.#.#...#.###...#.......#.#.#...#########.....#...#.....#.....###...#.....#.#.........#...#' union all select [Id] = '99' , [col] = '#.#######.###.#.###############.#####.#.###.#.#.#.#.#.###.#.#####.#.#######.#.###.#############.#.#.#.###.#.###.###.###.#####.#.#######.###.#' union all select [Id] = '100' , [col] = '#.#.....#.....#.#...###...#...#.#...#...###.#.#.#.#.#.#...#...###.#.###...#.#...#.......#######...#...#...#.#...#...#...#...#.#.......#.#...#' union all select [Id] = '101' , [col] = '#.#.###.#######.#.#.###.#.#.#.#.#.#.#######.#.#.#.#.#.#.#####.###.#.###.#.#.###.#######.###############.###.#.###.###.###.#.#.#######.#.#.###' union all select [Id] = '102' , [col] = '#...###.......#.#.#...#.#...#...#.#.......#.#.#.#...#.#.#.....#...#...#.#...#...###...#.#####...#...###.....#.....#...#...#.#.#...#...#.#...#' union all select [Id] = '103' , [col] = '#############.#.#.###.#.#########.#######.#.#.#.#####.#.#.#####.#####.#.#####.#####.#.#.#####.#.#.#.###############.###.###.#.#.#.#.###.###.#' union all select [Id] = '104' , [col] = '#.....###.....#.#...#.#...#.......#.......#.#.#...#...#.#.#...#...#...#...#...#...#.#.#.#####.#.#.#.#...#.......#...###.#...#.#.#...#...#...#' union all select [Id] = '105' , [col] = '#.###.###.#####.###.#.###.#.#######.#######.#.###.#.###.#.#.#.###.#.#####.#.###.#.#.#.#.#####.#.#.#.#.#.#.#####.#.#####.#.###.#.#####.###.###' union all select [Id] = '106' , [col] = '#.#...#...#...#.....#.....#.#...#...#.......#.#...#.#...#.#.#.#...#...#...#...#.#.#.#...###...#.#.#...#.#.....#.#.......#...#.#...###.....###' union all select [Id] = '107' , [col] = '#.#.###.###.#.#############.#.#.#.###.#######.#.###.#.###.#.#.#.#####.#.#####.#.#.#.#######.###.#.#####.#####.#.###########.#.###.###########' union all select [Id] = '108' , [col] = '#.#.....#...#.....#...#.....#.#...#...#.......#...#.#.#...#.#.#.....#.#.#.....#.#.#...#####.#...#.#...#.#.....#.............#.....#.........#' union all select [Id] = '109' , [col] = '#.#######.#######.#.#.#.#####.#####.###.#########.#.#.#.###.#.#####.#.#.#.#####.#.###.#####.#.###.#.#.#.#.#########################.#######.#' union all select [Id] = '110' , [col] = '#.........#.......#.#...#.....#...#.###.....#...#.#.#.#...#.#.#.....#.#.#.#.....#.#...###...#...#.#.#...#.................###...###.#.......#' union all select [Id] = '111' , [col] = '###########.#######.#####.#####.#.#.#######.#.#.#.#.#.###.#.#.#.#####.#.#.#.#####.#.#####.#####.#.#.#####################.###.#.###.#.#######' union all select [Id] = '112' , [col] = '#.........#.......#...#...#...#.#.#.......#.#.#.#.#.#.#...#.#.#.#...#...#.#.###...#...###.....#.#.#.#.....#...#.....#.....#...#.....#...#...#' union all select [Id] = '113' , [col] = '#.#######.#######.###.#.###.#.#.#.#######.#.#.#.#.#.#.#.###.#.#.#.#.#####.#.###.#####.#######.#.#.#.#.###.#.#.#.###.#.#####.###########.#.#.#' union all select [Id] = '114' , [col] = '#.#.....#.........#...#...#.#.#.#...#.....#.#.#.#.#.#.#...#.#.#...#.....#.#.#...#.....#S#.....#...#.#.###...#.#...#.#.......#.....#.....#.#.#' union all select [Id] = '115' , [col] = '#.#.###.###########.#####.#.#.#.###.#.#####.#.#.#.#.#.###.#.#.#########.#.#.#.###.#####.#.#########.#.#######.###.#.#########.###.#.#####.#.#' union all select [Id] = '116' , [col] = '#.#.###.......#...#.#...#...#...###.#...#...#.#...#.#...#.#.#.#...#...#.#...#.#...#.....#.###...#...#.....###...#.#.....#...#...#.#.......#.#' union all select [Id] = '117' , [col] = '#.#.#########.#.#.#.#.#.###########.###.#.###.#####.###.#.#.#.#.#.#.#.#.#####.#.###.#####.###.#.#.#######.#####.#.#####.#.#.###.#.#########.#' union all select [Id] = '118' , [col] = '#...#...#.....#.#...#.#.#...........#...#...#...#...#...#.#.#.#.#.#.#.#...###.#.#...#...#.#...#...#.....#.....#.#.....#.#.#.#...#...#...#...#' union all select [Id] = '119' , [col] = '#####.#.#.#####.#####.#.#.###########.#####.###.#.###.###.#.#.#.#.#.#.###.###.#.#.###.#.#.#.#######.###.#####.#.#####.#.#.#.#.#####.#.#.#.###' union all select [Id] = '120' , [col] = '#.....#...#...#.#.....#.#...#...#...#...#...#...#...#...#...#.#.#.#.#...#.#...#.#...#.#.#.#.......#.###...#...#.......#...#...#####.#.#.#...#' union all select [Id] = '121' , [col] = '#.#########.#.#.#.#####.###.#.#.#.#.###.#.###.#####.###.#####.#.#.#.###.#.#.###.###.#.#.#.#######.#.#####.#.#######################.#.#.###.#' union all select [Id] = '122' , [col] = '#.........#.#.#.#.#...#.....#.#.#.#.#...#...#.....#...#...#...#.#.#.###...#...#...#.#.#...#.......#...#...#.....#...............#...#.#.#...#' union all select [Id] = '123' , [col] = '#########.#.#.#.#.#.#.#######.#.#.#.#.#####.#####.###.###.#.###.#.#.#########.###.#.#.#####.#########.#.#######.#.#############.#.###.#.#.###' union all select [Id] = '124' , [col] = '###...#...#.#.#.#...#...#...#.#.#.#.#...#...#.....###.....#.#...#.#.#.........#...#.#...#...#...#...#.#.#.....#...#...#...#.....#...#.#...###' union all select [Id] = '125' , [col] = '###.#.#.###.#.#.#######.#.#.#.#.#.#.###.#.###.#############.#.###.#.#.#########.###.###.#.###.#.#.#.#.#.#.###.#####.#.#.#.#.#######.#.#######' union all select [Id] = '126' , [col] = '#...#...#...#...###...#.#.#.#.#.#.#.#...#...#.........#.....#.###...#...#.....#...#.#...#...#.#.#.#.#.#.#...#.#.....#...#.#.....#...#.......#' union all select [Id] = '127' , [col] = '#.#######.#########.#.#.#.#.#.#.#.#.#.#####.#########.#.#####.#########.#.###.###.#.#.#####.#.#.#.#.#.#.###.#.#.#########.#####.#.#########.#' union all select [Id] = '128' , [col] = '#...#...#.###.......#...#.#.#.#...#.#...###.#.....#...#.#.....#.........#...#...#.#.#.###...#.#.#.#...#.#...#.#...#.......#...#.#.#.........#' union all select [Id] = '129' , [col] = '###.#.#.#.###.###########.#.#.#####.###.###.#.###.#.###.#.#####.###########.###.#.#.#.###.###.#.#.#####.#.###.###.#.#######.#.#.#.#.#########' union all select [Id] = '130' , [col] = '###...#.#...#...#.........#...#.....#...#...#...#...###...#.....#...#...#...#...#.#.#.#...#...#.#.#.....#...#.....#.#...#...#.#.#.#.........#' union all select [Id] = '131' , [col] = '#######.###.###.#.#############.#####.###.#####.###########.#####.#.#.#.#.###.###.#.#.#.###.###.#.#.#######.#######.#.#.#.###.#.#.#########.#' union all select [Id] = '132' , [col] = '#.......#...###...#.............#...#...#.#...#...#...###...#...#.#.#.#.#...#...#.#.#.#...#.###.#.#...#...#.......#.#.#...###.#.#.#...#...#.#' union all select [Id] = '133' , [col] = '#.#######.#########.#############.#.###.#.#.#.###.#.#.###.###.#.#.#.#.#.###.###.#.#.#.###.#.###.#.###.#.#.#######.#.#.#######.#.#.#.#.#.#.#.#' union all select [Id] = '134' , [col] = '#...#...#.#...#.....#...#...#...#.#.#...#.#.#...#...#...#.#...#.#.#.#.#...#.#...#.#.#.#...#.#...#.#...#.#.#...#...#.#.......#.#.#.#.#.#.#.#.#' union all select [Id] = '135' , [col] = '###.#.#.#.#.#.#.#####.#.#.#.#.#.#.#.#.###.#.###.#######.#.#.###.#.#.#.###.#.#.###.#.#.#.###.#.###.#.###.#.#.#.#.###.#######.#.#.#.#.#.#.#.#.#' union all select [Id] = '136' , [col] = '###.#.#.#...#.#...#...#.#.#.#.#...#.#...#.#.#...#...#...#...###...#.#.#...#.#...#.#.#.#.....#...#.#...#.#.#.#.#...#...#.....#.#.#...#...#.#.#' union all select [Id] = '137' , [col] = '###.#.#.#####.###.#.###.#.#.#.#####.###.#.#.#.###.#.#.#############.#.#.###.###.#.#.#.#########.#.###.#.#.#.#.###.###.#.#####.#.#########.#.#' union all select [Id] = '138' , [col] = '#...#.#...#...#...#.#...#.#.#.....#...#.#.#.#.#...#.#.......#.......#.#...#.#...#.#.#...#.......#.#...#.#.#.#.#...#...#.....#.#.#.........#.#' union all select [Id] = '139' , [col] = '#.###.###.#.###.###.#.###.#.#####.###.#.#.#.#.#.###.#######.#.#######.###.#.#.###.#.###.#.#######.#.###.#.#.#.#.###.#######.#.#.#.#########.#' union all select [Id] = '140' , [col] = '#.....###...###.....#.....#.......###...#...#...###.........#.........###...#.....#.....#.........#.....#...#...###.........#...#...........#' union all select [Id] = '141' , [col] = '#############################################################################################################################################' 

--select * from #input


drop table if exists #base 


; with cte as 
(
select 
r = cast(id as int)
, c = 1 
, ch = left(col, 1)
, rem = right(col, len(col)-1)
from #input
union all 
select 
r  
, c + 1 
, ch = left(rem, 1)
, rem = right(rem, len(rem)-1)
from cte
where rem != ''
) 
select r, c, ch into #base from cte
option (maxrecursion 0)




select map = STRING_AGG(ch, '') within group(order by r, c )
from #base


select * from #base A inner join #base B 
on (A.r = B.r and abs(A.c - B.c) =1 )
     or 
   (A.c = B.c and abs(A.r - B.r) =1 )
where A.ch in ('S', '.')
and B.ch in ('E', '.') 


-- base path = 83 
select count(*) + 1  from #base
where ch = '.'


-- ; with cte as 
-- (
-- select 
-- step = 1 
-- , r
-- , c 
-- , ch
-- , map = (select map = STRING_AGG(ch, '') within group(order by r, c )from #base)
-- from #base
-- where ch = 'S'

-- union all 

-- select 



-- )